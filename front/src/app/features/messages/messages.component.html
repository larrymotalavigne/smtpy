<div class="messages-container p-4">
  <div class="grid">
    <div class="col-12">
      <p-card>
        <ng-template pTemplate="header">
          <div class="flex align-items-center justify-content-between p-3">
            <div class="flex align-items-center gap-2">
              <i class="pi pi-envelope text-2xl text-primary"></i>
              <h2 class="text-2xl font-bold text-900 m-0">Messages</h2>
            </div>
            <div class="flex gap-2">
              <p-button label="Filters" icon="pi pi-filter" styleClass="p-button-outlined"></p-button>
              <p-button label="Export" icon="pi pi-download" styleClass="p-button-outlined"></p-button>
            </div>
          </div>
        </ng-template>
        <p class="text-600 line-height-3 mb-3">
          View and manage your email messages and forwarding history.
        </p>
        <p-table [value]="messages" [paginator]="true" [rows]="20" [responsive]="true" [loading]="false">
          <ng-template pTemplate="header">
            <tr>
              <th>From</th>
              <th>To</th>
              <th>Subject</th>
              <th>Status</th>
              <th>Size</th>
              <th>Date</th>
              <th>Actions</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-message>
            <tr>
              <td>{{message.sender_email}}</td>
              <td>{{message.recipient_email}}</td>
              <td class="max-w-xs truncate">{{message.subject || '(No Subject)'}}</td>
              <td>
                <p-tag [value]="message.status" 
                       [severity]="getStatusSeverity(message.status)">
                </p-tag>
              </td>
              <td>{{formatSize(message.size_bytes)}}</td>
              <td>{{formatDate(message.created_at)}}</td>
              <td>
                <p-button icon="pi pi-eye" styleClass="p-button-text p-button-sm mr-2" 
                          pTooltip="View Details"></p-button>
                <p-button icon="pi pi-paperclip" styleClass="p-button-text p-button-sm" 
                          [disabled]="!message.has_attachments"
                          pTooltip="Attachments"></p-button>
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="7" class="text-center p-4">
                <i class="pi pi-envelope text-4xl text-400 mb-2 block"></i>
                <p class="text-600 m-0">No messages found. Messages will appear here once emails are received.</p>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </p-card>
    </div>
  </div>
</div>